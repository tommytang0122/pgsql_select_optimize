# GZip 壓縮實作說明

## 概述

GZip 壓縮可以大幅減少 HTTP 回應的傳輸大小，特別適合 JSON 這類文字資料。

## 原理

```
無壓縮:
┌─────────────────┐                      ┌─────────────────┐
│  Server         │  ──── 20MB JSON ───▶ │  Browser        │
│                 │                      │                 │
└─────────────────┘                      └─────────────────┘

GZip 壓縮:
┌─────────────────┐                      ┌─────────────────┐
│  Server         │  ──── 4MB GZip ────▶ │  Browser        │
│  (壓縮)         │                      │  (自動解壓)     │
└─────────────────┘                      └─────────────────┘
                        節省 80%!
```

## 實作細節

### 設定位置

**檔案**: `main.py` 第 22-23 行

```python
# GZip 壓縮設定
USE_GZIP = False             # 目前: 關閉 (本地測試建議關閉)
GZIP_MIN_SIZE = 500          # 最小壓縮大小 (bytes)
```

### 參數說明

| 參數 | 說明 | 目前值 |
|------|------|--------|
| `USE_GZIP` | 是否啟用 GZip | `False` |
| `GZIP_MIN_SIZE` | 小於此大小不壓縮 | `500` bytes |

## 壓縮效果測試結果

| 資料筆數 | 原始大小 | 壓縮後 | 壓縮率 |
|---------|---------|--------|--------|
| 10,000 | ~2.1MB | ~723KB | 66% |
| 100,000 | ~20MB | ~7MB | 65% |

## ⚠️ 重要發現：localhost 環境

測試結果 (100,000 筆):
| 模式 | 時間 |
|------|------|
| 無 GZip | **2.8 秒** ✅ |
| 有 GZip | **6.1 秒** ❌ |

**結論**: localhost 環境下，壓縮的 CPU 開銷大於網路節省，**建議關閉**。

## 適用場景

| 環境 | 建議 | 原因 |
|------|------|------|
| localhost | ❌ 關閉 | 網路快，CPU 開銷反而更慢 |
| 內網 (LAN) | ⚖️ 視情況 | 需測試比較 |
| 公網 / CDN | ✅ 開啟 | 網路慢，壓縮節省明顯 |

## 開關切換

```python
# main.py 第 22 行

USE_GZIP = True   # 啟用 (適合生產環境)
USE_GZIP = False  # 停用 (目前，適合本地測試)
```

修改後需重啟伺服器。

## 啟動訊息

```
啟用時: ✅ GZip 壓縮已啟用 (minimum_size=500)
停用時: ⚠️ GZip 壓縮已停用
```
